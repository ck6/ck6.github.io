<!DOCTYPE html>
<html>
<head>
  <script src="https://telegram.org/js/telegram-web-app.js?56"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js/dist/umd/supabase.js"></script>
  <title>My Telegram Web App</title>
</head>
<body style="background-color:white;">
  <h1>Welcome to My Web App2</h1>
  <p id="demo1"></p>
  <p id="demo"></p>
  <div id="output"></div>

  <script>
 
      if (!window.Telegram || !window.Telegram.WebApp) {
    document.getElementById("demo1").innerHTML = 'No object found';
  } else {
    document.getElementById("demo1").innerHTML = 'Found';
  }


    // The Telegram WebApp object
    const tg = window.Telegram.WebApp;

    // Initialize
    tg.ready(); 
    tg.expand();
    // Or in older docs: tg.expand(); (to expand the window, optional)

    // You can get user info from initDataUnsafe
    const user = tg.initDataUnsafe.user;
    if (user) {
      const userId = user.id;
      const firstName = user.first_name;
      const lastName = user.last_name;
      const username = user.username;
      const profilephoto = user.photo_url;

      console.log('Telegram user ID:', userId);
      console.log('First name:', firstName);
      console.log('Last name:', lastName);
      console.log('Username:', username);
      document.getElementById("demo").innerHTML = 'Telegram user ID:' + userId + username + firstName +  ' ' + profilephoto;
    } else {
      document.getElementById("demo").innerHTML = 'No user info available.';
    }


    //Supadb
    const supabaseUrl = 'https://lsnpgojvhnlfehdhkwul.supabase.co';  // Replace with your own
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxzbnBnb2p2aG5sZmVoZGhrd3VsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzQ4MTQ3MjIsImV4cCI6MjA1MDM5MDcyMn0.W6a7TbRyC4eTD1zc-LfEyHw7lCNXRryd4CLMEN-JmkE';                  // Replace with your own
    const supabase = supabase.createClient(supabaseUrl, supabaseKey);

    // 2. Example: Read data from a table named 'items'
    async function getItems() {
      const { data, error } = await supabase.from('items').select('*');
      
      if (error) {
        console.error('Error fetching items:', error);
      } else {
        console.log('Items:', data);
        document.getElementById('output').textContent = JSON.stringify(data, null, 2);
      }
    }

    // 3. Example: Insert data
    async function addNewItem(newItem) {
      const { data, error } = await supabase.from('items').insert([ newItem ]);
      if (error) {
        console.error('Error inserting item:', error);
      } else {
        console.log('Insert response:', data);
      }
    }

    // Fetch items on page load
    getItems();

    // Insert a new item (uncomment to test)
    // addNewItem({ name: 'Test Item', description: 'This is a test' });




  </script>
</body>
</html>
